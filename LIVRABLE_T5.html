<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Th√®me 5: La r√©gr√©ssion lin√©aire</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="LIVRABLE_T5_files/libs/clipboard/clipboard.min.js"></script>
<script src="LIVRABLE_T5_files/libs/quarto-html/quarto.js"></script>
<script src="LIVRABLE_T5_files/libs/quarto-html/popper.min.js"></script>
<script src="LIVRABLE_T5_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="LIVRABLE_T5_files/libs/quarto-html/anchor.min.js"></script>
<link href="LIVRABLE_T5_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="LIVRABLE_T5_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="LIVRABLE_T5_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="LIVRABLE_T5_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="LIVRABLE_T5_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="LIVRABLE_T5_files/libs/kePrint-0.0.1/kePrint.js"></script>

<link href="LIVRABLE_T5_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="LIVRABLE_T5_files/styles.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#mise-en-situation-1" id="toc-mise-en-situation-1" class="nav-link active" data-scroll-target="#mise-en-situation-1"><span class="header-section-number">0.1</span> Mise en situation 1</a></li>
  <li><a href="#objectif" id="toc-objectif" class="nav-link" data-scroll-target="#objectif"><span class="header-section-number">0.2</span> Objectif</a></li>
  <li><a href="#lien-entre-deux-variables-quantitatives-rappel" id="toc-lien-entre-deux-variables-quantitatives-rappel" class="nav-link" data-scroll-target="#lien-entre-deux-variables-quantitatives-rappel"><span class="header-section-number">0.3</span> Lien entre deux variables quantitatives (rappel)</a></li>
  <li><a href="#diagnostic-graphique-diagramme-de-dispersion" id="toc-diagnostic-graphique-diagramme-de-dispersion" class="nav-link" data-scroll-target="#diagnostic-graphique-diagramme-de-dispersion"><span class="header-section-number">0.4</span> Diagnostic graphique: diagramme de dispersion</a></li>
  <li><a href="#coefficient-de-corr√©lation-de-pearson" id="toc-coefficient-de-corr√©lation-de-pearson" class="nav-link" data-scroll-target="#coefficient-de-corr√©lation-de-pearson"><span class="header-section-number">0.5</span> Coefficient de corr√©lation de Pearson</a></li>
  <li><a href="#calcul-du-coefficient-de-corr√©lation-de-pearson" id="toc-calcul-du-coefficient-de-corr√©lation-de-pearson" class="nav-link" data-scroll-target="#calcul-du-coefficient-de-corr√©lation-de-pearson"><span class="header-section-number">0.6</span> Calcul du coefficient de corr√©lation de Pearson</a></li>
  <li><a href="#mod√®le-de-r√©gression-lin√©aire" id="toc-mod√®le-de-r√©gression-lin√©aire" class="nav-link" data-scroll-target="#mod√®le-de-r√©gression-lin√©aire"><span class="header-section-number">0.7</span> Mod√®le de r√©gression lin√©aire</a></li>
  <li><a href="#analyse-de-la-variance" id="toc-analyse-de-la-variance" class="nav-link" data-scroll-target="#analyse-de-la-variance"><span class="header-section-number">0.8</span> Analyse de la variance</a></li>
  <li><a href="#validation-du-mod√®le" id="toc-validation-du-mod√®le" class="nav-link" data-scroll-target="#validation-du-mod√®le"><span class="header-section-number">0.9</span> Validation du mod√®le</a></li>
  <li><a href="#coefficient-de-determination-r¬≤-mesure-de-performance-du-mod√®le" id="toc-coefficient-de-determination-r¬≤-mesure-de-performance-du-mod√®le" class="nav-link" data-scroll-target="#coefficient-de-determination-r¬≤-mesure-de-performance-du-mod√®le"><span class="header-section-number">0.10</span> Coefficient de determination R¬≤ : mesure de performance du mod√®le</a></li>
  <li><a href="#la-statistique-r¬≤-ajust√©" id="toc-la-statistique-r¬≤-ajust√©" class="nav-link" data-scroll-target="#la-statistique-r¬≤-ajust√©"><span class="header-section-number">0.11</span> La statistique R¬≤ ajust√©</a></li>
  <li><a href="#exercice-1" id="toc-exercice-1" class="nav-link" data-scroll-target="#exercice-1"><span class="header-section-number">0.12</span> Exercice 1</a></li>
  <li><a href="#intervalle-de-confiance-pour-estimer-la-moyenne-conditionnelle-et-intervalle-de-pr√©vision" id="toc-intervalle-de-confiance-pour-estimer-la-moyenne-conditionnelle-et-intervalle-de-pr√©vision" class="nav-link" data-scroll-target="#intervalle-de-confiance-pour-estimer-la-moyenne-conditionnelle-et-intervalle-de-pr√©vision"><span class="header-section-number">0.13</span> Intervalle de confiance pour estimer la moyenne conditionnelle et intervalle de pr√©vision</a></li>
  <li><a href="#exercice-2" id="toc-exercice-2" class="nav-link" data-scroll-target="#exercice-2"><span class="header-section-number">0.14</span> Exercice 2:</a></li>
  <li><a href="#exercice-3" id="toc-exercice-3" class="nav-link" data-scroll-target="#exercice-3"><span class="header-section-number">0.15</span> Exercice 3</a></li>
  <li><a href="#r√©gression-avec-variable-service-seulement" id="toc-r√©gression-avec-variable-service-seulement" class="nav-link" data-scroll-target="#r√©gression-avec-variable-service-seulement"><span class="header-section-number">0.16</span> R√©gression avec variable service seulement</a></li>
  <li><a href="#r√©gression-avec-service-qualit√©-et-d√©cor." id="toc-r√©gression-avec-service-qualit√©-et-d√©cor." class="nav-link" data-scroll-target="#r√©gression-avec-service-qualit√©-et-d√©cor."><span class="header-section-number">0.17</span> R√©gression avec service, qualit√© et d√©cor.</a></li>
  <li><a href="#mod√©lisation-avec-variables-explicatives-cat√©gorielles" id="toc-mod√©lisation-avec-variables-explicatives-cat√©gorielles" class="nav-link" data-scroll-target="#mod√©lisation-avec-variables-explicatives-cat√©gorielles"><span class="header-section-number">0.18</span> Mod√©lisation avec variables explicatives cat√©gorielles</a></li>
  <li><a href="#mise-en-situation-2" id="toc-mise-en-situation-2" class="nav-link" data-scroll-target="#mise-en-situation-2"><span class="header-section-number">0.19</span> Mise en situation 2</a></li>
  <li><a href="#exercice-4" id="toc-exercice-4" class="nav-link" data-scroll-target="#exercice-4"><span class="header-section-number">0.20</span> Exercice 4</a></li>
  <li><a href="#d√©marche-et-solution" id="toc-d√©marche-et-solution" class="nav-link" data-scroll-target="#d√©marche-et-solution"><span class="header-section-number">0.21</span> D√©marche et solution</a></li>
  <li><a href="#test-de-significativit√©-globale-pour-un-sous-ensemble-de-variable" id="toc-test-de-significativit√©-globale-pour-un-sous-ensemble-de-variable" class="nav-link" data-scroll-target="#test-de-significativit√©-globale-pour-un-sous-ensemble-de-variable"><span class="header-section-number">0.22</span> Test de significativit√© globale pour un sous ensemble de variable</a></li>
  <li><a href="#mod√®le-hi√©rarchique-ou-r√©gression-s√©quentielle" id="toc-mod√®le-hi√©rarchique-ou-r√©gression-s√©quentielle" class="nav-link" data-scroll-target="#mod√®le-hi√©rarchique-ou-r√©gression-s√©quentielle"><span class="header-section-number">0.23</span> Mod√®le hi√©rarchique ou r√©gression s√©quentielle</a></li>
  <li><a href="#m√©thodes-de-s√©lection-de-mod√®les-stepwise" id="toc-m√©thodes-de-s√©lection-de-mod√®les-stepwise" class="nav-link" data-scroll-target="#m√©thodes-de-s√©lection-de-mod√®les-stepwise"><span class="header-section-number">0.24</span> M√©thodes de S√©lection de mod√®les (Stepwise)</a></li>
  <li><a href="#m√©thodes-de-s√©lection-de-mod√®les-backward" id="toc-m√©thodes-de-s√©lection-de-mod√®les-backward" class="nav-link" data-scroll-target="#m√©thodes-de-s√©lection-de-mod√®les-backward"><span class="header-section-number">0.25</span> M√©thodes de S√©lection de mod√®les (Backward)</a></li>
  <li><a href="#s√©lection-du-meilleur-mod√®le-selon-un-crit√®re" id="toc-s√©lection-du-meilleur-mod√®le-selon-un-crit√®re" class="nav-link" data-scroll-target="#s√©lection-du-meilleur-mod√®le-selon-un-crit√®re"><span class="header-section-number">0.26</span> S√©lection du meilleur mod√®le selon un crit√®re</a></li>
  <li><a href="#interaction" id="toc-interaction" class="nav-link" data-scroll-target="#interaction"><span class="header-section-number">0.27</span> Interaction</a></li>
  <li><a href="#exemple-pour-illustrer-linteraction" id="toc-exemple-pour-illustrer-linteraction" class="nav-link" data-scroll-target="#exemple-pour-illustrer-linteraction"><span class="header-section-number">0.28</span> Exemple pour illustrer l‚Äôinteraction</a></li>
  <li><a href="#multicolin√©arit√©" id="toc-multicolin√©arit√©" class="nav-link" data-scroll-target="#multicolin√©arit√©"><span class="header-section-number">0.29</span> Multicolin√©arit√©</a></li>
  <li><a href="#diagnostic-de-la-multicolin√©arit√©" id="toc-diagnostic-de-la-multicolin√©arit√©" class="nav-link" data-scroll-target="#diagnostic-de-la-multicolin√©arit√©"><span class="header-section-number">0.30</span> Diagnostic de la multicolin√©arit√©</a></li>
  <li><a href="#validit√©-du-mod√®le-de-r√©gression-lin√©aire" id="toc-validit√©-du-mod√®le-de-r√©gression-lin√©aire" class="nav-link" data-scroll-target="#validit√©-du-mod√®le-de-r√©gression-lin√©aire"><span class="header-section-number">0.31</span> Validit√© du mod√®le de r√©gression lin√©aire</a></li>
  <li><a href="#√©tapes-pour-valider-le-mod√®le" id="toc-√©tapes-pour-valider-le-mod√®le" class="nav-link" data-scroll-target="#√©tapes-pour-valider-le-mod√®le"><span class="header-section-number">0.32</span> √âtapes pour valider le mod√®le</a></li>
  <li><a href="#transformation" id="toc-transformation" class="nav-link" data-scroll-target="#transformation"><span class="header-section-number">0.33</span> Transformation</a></li>
  <li><a href="#ajout-de-termes-polynomiaux" id="toc-ajout-de-termes-polynomiaux" class="nav-link" data-scroll-target="#ajout-de-termes-polynomiaux"><span class="header-section-number">0.34</span> Ajout de termes polynomiaux</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Th√®me 5: La r√©gr√©ssion lin√©aire</h1>
</div>



<div class="quarto-title-meta column-page-right">

    
  
    
  </div>
  


</header>


<section id="mise-en-situation-1" class="level3" data-number="0.1">
<h3 data-number="0.1" class="anchored" data-anchor-id="mise-en-situation-1"><span class="header-section-number">0.1</span> Mise en situation 1</h3>
<p>Au cours d‚Äôune enqu√™te men√©e en 2001, un chercheur a demand√© aux clients d‚Äô√©valuer 168 restaurants Italiens situ√©s dans la ville de New York en fonction de trois aspects diff√©rents: la qualit√© de la nourriture, la d√©coration et le service. Les variables disponibles dans la base de donn√©es ¬´Restaurants.csv¬ª sont d√©finies comme suit:</p>
<p><strong>Variables</strong></p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 10%">
<col style="width: 89%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Nom_Variable</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Nom</td>
<td style="text-align: left;">Nom du restaurant</td>
</tr>
<tr class="even">
<td style="text-align: left;">Prix</td>
<td style="text-align: left;">Prix du d√Æner incluant une boisson et le pourboire</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Qualit√©</td>
<td style="text-align: left;">Score d‚Äô√©valuation de la qualit√© de la nourriture sur une √©chelle de 0 √† 30</td>
</tr>
<tr class="even">
<td style="text-align: left;">D√©cor</td>
<td style="text-align: left;">Score d‚Äô√©valuation de la d√©coration du restaurant sur une √©chelle de 0 √† 30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Service</td>
<td style="text-align: left;">Score d‚Äô√©valuation du service sur une √©chelle de 0 √† 30</td>
</tr>
<tr class="even">
<td style="text-align: left;">Emplacement</td>
<td style="text-align: left;">1 : restaurant situ√© √† l‚ÄôEst de la cinqui√®me avenue ; 0 : restaurant situ√© √† l‚ÄôOuest de la cinqui√®me avenue</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># D√©finir le r√©pertoire de travail</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"C:/Users/Fatou/OneDrive - HEC Montr√©al/PROJET SUPERVISE/Data"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Charger les donn√©es</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>resto<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">"Restaurants.csv"</span>,<span class="at">sep=</span><span class="st">";"</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir la variable Emplacement en facteur </span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>resto<span class="sc">$</span>Emplacement <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(resto<span class="sc">$</span>Emplacement)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="objectif" class="level3" data-number="0.2">
<h3 data-number="0.2" class="anchored" data-anchor-id="objectif"><span class="header-section-number">0.2</span> Objectif</h3>
<p>On s‚Äôint√©resse, en r√®gle g√©n√©rale, aux types de liens qui existent entre diff√©rentes variables.</p>
<p><strong>Exemples</strong></p>
<ul>
<li><p>Existe-t-il un lien entre le prix d‚Äôun repas et la qualit√© du restaurant?</p></li>
<li><p>La qualit√© a-t-elle un impact significatif sur le prix du repas?</p></li>
<li><p>Le prix varie-t-il en fonction de l‚Äôemplacement du restaurant?</p></li>
<li><p>Est-ce que le service, le d√©cor, la qualit√© et l‚Äôemplacement ont un impact sur le prix d‚Äôun d√Æner dans un restaurant italien?</p></li>
</ul>
<p>Le type de variables et le nombre de variables impliqu√©es dans les relations qui nous int√©ressent guident le choix de la m√©thode et de la direction de notre analyse.</p>
</section>
<section id="lien-entre-deux-variables-quantitatives-rappel" class="level3" data-number="0.3">
<h3 data-number="0.3" class="anchored" data-anchor-id="lien-entre-deux-variables-quantitatives-rappel"><span class="header-section-number">0.3</span> Lien entre deux variables quantitatives (rappel)</h3>
<p>Pour d√©tecter, mesurer et interpr√©ter un <strong>lien lin√©aire</strong> entre deux variables quantitatives, on commence, dans l‚Äôordre, par:</p>
<p>1-Effectuer un diagnostic graphique (<strong>nuage de point /diagramme de dispersion/ scatterplot</strong>) pour d√©tecter le mouvement conjoint dans la variation des deux variables.</p>
<p>2-Calculer le <strong>coefficient de corr√©lation lin√©aire</strong> observ√© dans l‚Äô√©chantillon.</p>
<p>3-Tester la <strong>significativit√© du lien</strong> lin√©aire entre les deux variables.</p>
</section>
<section id="diagnostic-graphique-diagramme-de-dispersion" class="level3" data-number="0.4">
<h3 data-number="0.4" class="anchored" data-anchor-id="diagnostic-graphique-diagramme-de-dispersion"><span class="header-section-number">0.4</span> Diagnostic graphique: diagramme de dispersion</h3>
<p>Un diagramme de dispersion permet:</p>
<ul>
<li><p>de valider si une relation semble exister entre les variables&nbsp;;</p></li>
<li><p>de visualiser le type de la relation (lin√©aire ou autre)&nbsp;;</p></li>
<li><p>de v√©rifier s‚Äôil y a des valeurs qui diff√®rent de la tendance (valeurs aberrantes ou extr√™mes</p></li>
</ul>
<p><strong>Exemple 1: relation entre qualit√© et prix</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Charger les biblioth√®ques n√©cessaires</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Cr√©er un scatter plot pour visualiser la relation entre qualit√© et prix</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> resto, <span class="fu">aes</span>(<span class="at">x =</span> Qualit√©, <span class="at">y =</span> Prix)) <span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Cercle vide</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>  <span class="co"># Th√®me simple</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relation entre qualit√© et prix"</span>, <span class="at">x =</span> <span class="st">"Qualit√©"</span>, <span class="at">y =</span> <span class="st">"Prix"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="LIVRABLE_T5_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="coefficient-de-corr√©lation-de-pearson" class="level3" data-number="0.5">
<h3 data-number="0.5" class="anchored" data-anchor-id="coefficient-de-corr√©lation-de-pearson"><span class="header-section-number">0.5</span> Coefficient de corr√©lation de Pearson</h3>
<p><strong>Rappel</strong>: La corr√©lation (aussi appel√©e coefficient de corr√©lation de Pearson) mesure la force et la direction de la relation lin√©aire entre deux variables quantitatives sur une √©chelle allant de -1 √† 1.</p>
<p>On d√©note la corr√©lation observ√©e dans l‚Äô√©chantillon par r (le coefficient de corr√©lation dans la population est not√© par œÅ ).</p>
<p><span class="math display">\[
r = \frac{\sum\limits_{i=1}^{n} (X_i - \overline{X})(Y_i - \overline{Y})}
{\sqrt{\sum\limits_{i=1}^{n} (X_i - \overline{X})^2 \sum\limits_{i=1}^{n} (Y_i - \overline{Y})^2}}
\]</span></p>
<p>Plus on est pr√®s des extr√©mit√©s de l‚Äô√©chelle (-1 ou 1), plus l‚Äôintensit√© de la relation est forte.</p>
<ul>
<li><p><strong>Un coefficient <em>r</em> = -1</strong>&nbsp;: une parfaite relation n√©gative.</p></li>
<li><p><strong>Un coefficient <em>r</em> = 0</strong>&nbsp;: il n‚Äôy a <strong>aucune relation lin√©aire</strong> entre les variables ou il y a une relation entre les deux variables mais le lien n‚Äôest pas lin√©aire.</p></li>
<li><p><strong>Un coefficient <em>r</em> = 1</strong>&nbsp;: une parfaite relation <strong>positive.</strong></p></li>
</ul>
<p>Attention r peut √™tre influenc√© par la pr√©sence de valeurs extr√™mes ou aberrantes d‚Äôo√π l‚Äôimportance du diagnostique graphique.</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="LIVRABLE_T5_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="calcul-du-coefficient-de-corr√©lation-de-pearson" class="level3" data-number="0.6">
<h3 data-number="0.6" class="anchored" data-anchor-id="calcul-du-coefficient-de-corr√©lation-de-pearson"><span class="header-section-number">0.6</span> Calcul du coefficient de corr√©lation de Pearson</h3>
<p><span class="math display">\[
\textbf{Les hypoth√®ses :}
\]</span></p>
<p><span class="math display">\[
H_0 : \rho = 0 \quad \text{(Absence de relation lin√©aire)}
\]</span></p>
<p><span class="math display">\[
H_1 : \rho \neq 0 \quad \text{(Pr√©sence d‚Äôune relation lin√©aire)}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer la matrice de corr√©lation de Pearson entre les variables num√©riques</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(resto[, <span class="fu">c</span>(<span class="st">"Prix"</span>, <span class="st">"Qualit√©"</span>, <span class="st">"Service"</span>, <span class="st">"D√©cor"</span>)], <span class="at">method =</span> <span class="st">"pearson"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher la matrice de corr√©lation</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cor_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Prix   Qualit√©   Service     D√©cor
Prix    1.0000000 0.6270435 0.6411402 0.7243525
Qualit√© 0.6270435 1.0000000 0.7945248 0.5039161
Service 0.6411402 0.7945248 1.0000000 0.6453306
D√©cor   0.7243525 0.5039161 0.6453306 1.0000000</code></pre>
</div>
</div>
<section id="retour-√†-lexemple" class="level4" data-number="0.6.1">
<h4 data-number="0.6.1" class="anchored" data-anchor-id="retour-√†-lexemple"><span class="header-section-number">0.6.1</span> Retour √† l‚Äôexemple</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cr√©er un scatterplot avec une ligne de r√©gression lin√©aire</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(resto, <span class="fu">aes</span>(<span class="at">x =</span> Qualit√©, <span class="at">y =</span> Prix)) <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span>  </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Qualit√©"</span>, <span class="at">y =</span> <span class="st">"Prix"</span>, <span class="at">title =</span> <span class="st">"Relation entre Qualit√© et Prix"</span>) <span class="sc">+</span>  </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="LIVRABLE_T5_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>Les donn√©es observ√©es nous permettent de d√©tecter une d√©pendance lin√©aire assez forte et significative (au niveau 1%) entre la qualit√© des mets et le prix du repas.</p></li>
<li><p>Plus le score de qualit√© est √©lev√©, plus les prix ont aussi tendance √† √™tre √©lev√©s. Cette tendance se confirme aussi par la valeur du coefficient de corr√©lation lin√©aire (r = 0,627)</p></li>
<li><p>Comment peut-on utiliser l‚Äôinformation fournie par les donn√©es observ√©es pour ¬´&nbsp;pr√©dire&nbsp;¬ª les prix d‚Äôun repas pour un restaurant italien donn√©?</p></li>
<li><p>Pour ce faire, on peut mod√©liser la relation observ√©e entre les deux variables √† l‚Äôaide d‚Äôune fonction.</p></li>
</ul>
</section>
</section>
<section id="mod√®le-de-r√©gression-lin√©aire" class="level3" data-number="0.7">
<h3 data-number="0.7" class="anchored" data-anchor-id="mod√®le-de-r√©gression-lin√©aire"><span class="header-section-number">0.7</span> Mod√®le de r√©gression lin√©aire</h3>
<p>Le mod√®le de r√©gression lin√©aire est:</p>
<p><span class="math display">\[ Y = \beta_0 + \beta_1 X_1 + \dots + \beta_k X_k + \varepsilon \]</span></p>
<ul>
<li><p>Y = variable <strong>expliqu√©e</strong> ou <strong>d√©pendante</strong> ou r√©ponse</p></li>
<li><p>X‚ÇÅ, ‚Ä¶, X‚Çñ = variables <strong>explicatives</strong> ou <strong>ind√©pendantes</strong> (une seule dans le cas de la r√©gression simple, 2 ou plus pour la r√©gression multiple)</p></li>
<li><p>On dispose de n observations (X‚ÇÅ‚ÇÅ, ‚Ä¶, X‚Çñ‚ÇÅ, Y‚ÇÅ), (X‚ÇÅ‚ÇÇ, ‚Ä¶, X‚Çñ‚ÇÇ, Y‚ÇÇ), ‚Ä¶, (X‚ÇÅ‚Çô, ‚Ä¶, X‚Çñ‚Çô, Y‚Çô), sur ces variables.</p></li>
<li><p>Le terme ùùê est appel√© l<strong>‚Äôerreur du mod√®le</strong>.</p></li>
<li><p>L‚Äôerreur repr√©sente tous les autres facteurs ( omis dans l‚Äô√©quation) pouvant ¬´expliquer¬ª la valeur de Y.</p></li>
<li><p>Ce type de mod√®le est tr√®s souvent ad√©quat lorsque nous assumons que ùùê est une variable al√©atoire suivant une loi normale d‚Äôesp√©rance 0 et d‚Äô√©cart-type œÉ‚Çë.</p></li>
<li><p>Les param√®tres du mod√®les sont estim√©s par la m√©thode des moindres carr√©s</p></li>
</ul>
<p>Le mod√®le stipule qu‚Äôil existe une relation lin√©aire entre les variables explicatives (X‚ÇÅ, ‚Ä¶, X‚Çñ) et la moyenne des Y correspondants et non pas directement entre les variables explicatives (X‚ÇÅ, ‚Ä¶, X‚Çñ) et Y.</p>
<p>Par exemple, pour la r√©gression lin√©aire simple:</p>
<p><img src="images/clipboard-3195730040.png" class="img-fluid"></p>
</section>
<section id="analyse-de-la-variance" class="level3" data-number="0.8">
<h3 data-number="0.8" class="anchored" data-anchor-id="analyse-de-la-variance"><span class="header-section-number">0.8</span> Analyse de la variance</h3>
<p>On peut d√©composer la variabilit√© totale de Y en deux composantes :</p>
<ul>
<li><p>Celle qui est expliqu√©e par le mod√®le de r√©gression</p></li>
<li><p>et celle qui ne l‚Äôest pas (variation r√©siduelle <strong>due √† l‚Äôerreur</strong>).</p></li>
</ul>
<p><span class="math display">\[
\sum (y_i - \bar{y})^2 = \sum (\hat{y_i} - \bar{y})^2 + \sum (y_i - \hat{y_i})^2
\]</span></p>
<p><span class="math display">\[
SS_C = SS_R + SS_e
\]</span></p>
<p>Cette d√©composition nous permet d‚Äôobtenir un tableau d‚ÄôAnova √† partir duquel on pourra d√©velopper un test permettant de v√©rifier si <strong>la r√©gression est globalement significative</strong> pour expliquer la variabilit√© de Y (<strong>Test F</strong>).</p>
<p><strong><em>Tableau d‚Äôanalyse de la variance: cas g√©n√©ral</em></strong></p>
<div class="cell">
<div class="cell-output-display">
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Source.de.la.variation</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Somme.de.carr√©s</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Degr√©s.de.libert√©</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Carr√©.moyen</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center; font-weight: bold; color: black !important;">R√©gression</td>
<td style="text-align: center;">SS_R</td>
<td style="text-align: center;">k</td>
<td style="text-align: center;">MSR = SS_R / k</td>
<td style="text-align: center; font-weight: bold; color: black !important;">F = MSR / MSE</td>
</tr>
<tr class="even">
<td style="text-align: center; font-weight: bold; color: black !important;">R√©siduelle (erreur)</td>
<td style="text-align: center;">SS_e</td>
<td style="text-align: center;">n - k - 1</td>
<td style="text-align: center;">MSE = SS_e / (n-k-1)</td>
<td style="text-align: center; font-weight: bold; color: black !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: center; font-weight: bold; color: black !important;">Totale</td>
<td style="text-align: center;">SS_C</td>
<td style="text-align: center;">n - 1</td>
<td style="text-align: center;"></td>
<td style="text-align: center; font-weight: bold; color: black !important;"></td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</section>
<section id="validation-du-mod√®le" class="level3" data-number="0.9">
<h3 data-number="0.9" class="anchored" data-anchor-id="validation-du-mod√®le"><span class="header-section-number">0.9</span> Validation du mod√®le</h3>
<p>L‚Äô√©quation exp√©rimentale (mod√®le ajust√©) devient: <span class="math display">\[
\hat{Y} = b_0 + b_1 X_1 + b_2 X_2 + \dots + b_k X_k
\]</span></p>
<p><strong>1-Test sur la significativit√© globale: (Test F du tableau d‚ÄôANOVA).</strong></p>
<p><span class="math display">\[
H_0: \beta_1 = \beta_2 = \dots = \beta_p = 0 \quad \text{(Globalement, la r√©gression n‚Äôest pas significative)}
\]</span></p>
<p><span class="math display">\[
H_1: \text{au moins un de ces param√®tres} \neq 0 \quad \text{(Globalement, la r√©gression est significative)}
\]</span></p>
<p>Si H‚ÇÄ est vraie, la statistique du test: F = <span class="math display">\[
F = \frac{\frac{SSR}{(n-1)}}{\frac{SSE}{(n-p-1)}}
\]</span></p>
<p>Si on rejette H‚ÇÄ, on en conclut que le Mod√®le est globalement significatif c.a.d qu‚Äôil existe au moins une variable X utile pour expliquer le comportement de Y.</p>
<p><strong>2-Tests sur les contributions marginales individuelles (Tests T sur les coefficients).</strong></p>
<p>Il y a autant de tests individuels que de variables dans le mod√®le</p>
<p><span class="math display">\[
H_0: \beta_i = 0 \quad \text{vs} \quad H_1: \beta_i \neq 0, \quad i = 1, \dots, k
\]</span></p>
<ul>
<li><p>En r√©gression lin√©aire multiple, on teste la contribution partielle de X‚±º sachant que les autres variables sont dans le mod√®le.</p></li>
<li><p>Le non rejet de H‚ÇÄ veut dire qu‚Äôil n‚Äôy a pas de lien lin√©aire significatif entre X‚±º et Y une fois que l‚Äôon tient compte de toutes les autres variables dans le mod√®le.</p></li>
<li><p>Le rejet de H‚ÇÄ veut dire que la variable X‚±º contribue √† expliquer Y au del√† des autres variables dans le mod√®le.</p></li>
</ul>
<p><strong>Interpr√©tation des coefficients:</strong></p>
<p>b‚ÇÄ : repr√©sente la moyenne de Y lorsque X‚ÇÅ = 0, X‚ÇÇ = 0 ‚Ä¶ ùëíùë° X‚Çñ=0, <em>si cela a du sens</em>.</p>
<p>b‚±º : mesure <strong><em>l‚Äôeffet marginal ou la contribution marginale</em></strong> de la variable X‚±º <em>une fois que l‚Äôon tient compte des autres variables dans le mod√®le.</em></p>
<p>b‚±º : s‚Äôinterpr√®te comme la variation de la moyenne de Y lorsque X‚±º augmente d‚Äôune unit√©, <em>lorsque les autres variables demeurent inchang√©es.</em></p>
</section>
<section id="coefficient-de-determination-r¬≤-mesure-de-performance-du-mod√®le" class="level3" data-number="0.10">
<h3 data-number="0.10" class="anchored" data-anchor-id="coefficient-de-determination-r¬≤-mesure-de-performance-du-mod√®le"><span class="header-section-number">0.10</span> Coefficient de determination R¬≤ : mesure de performance du mod√®le</h3>
<p>Le coefficient de d√©termination R¬≤ mesure la proportion de la variabilit√© observ√©e de Y qui est expliqu√©e par la r√©gression.</p>
<p><span class="math display">\[
R^2 = \frac{SS_R}{SS_C}
\]</span></p>
<ul>
<li><p>Ce coefficient peut servir √† mesurer la performance du mod√®le comme outil de pr√©vision.</p></li>
<li><p>R¬≤ prend ses valeurs entre 0 et 1. Plus ce coefficient est grand, plus la relation lin√©aire est forte.</p></li>
<li><p>En r√©gression lin√©aire simple, ce coefficient est simplement √©gal au carr√© du coefficient de corr√©lation de Pearson.</p></li>
</ul>
</section>
<section id="la-statistique-r¬≤-ajust√©" class="level3" data-number="0.11">
<h3 data-number="0.11" class="anchored" data-anchor-id="la-statistique-r¬≤-ajust√©"><span class="header-section-number">0.11</span> La statistique R¬≤ ajust√©</h3>
<ul>
<li><p>En r√©gression lin√©aire multiple, la performance du mod√®le ajust√© est √©valu√© par son coefficient de d√©termination R¬≤.</p></li>
<li><p>Lorsque des variables ind√©pendantes additionnelles sont ajout√©es √† un mod√®le, le R¬≤ ne peut qu‚Äôaugmenter ce qui laisse √† croire, √† tort, que plus il y a de variables dans le mod√®le mieux c‚Äôest.</p></li>
<li><p>La statistique R¬≤ peut √™tre gonfl√©e artificiellement par l‚Äôajout de n‚Äôimporte quelle variable ind√©pendante au mod√®le.</p></li>
<li><p>Si on veut donc comparer des mod√®les ne comportant pas le m√™me nombre de variables explicatives, on utilisera une mesure qui p√©nalise l‚Äôajout de pr√©dicteurs. Cette mesure s‚Äôappelle le R¬≤ ajust√©.</p></li>
</ul>
<p><span class="math display">\[
R^2 = \frac{SS_E}{SS_T}
\]</span></p>
<p><span class="math display">\[
R^2ajust√© = 1-(\frac{SS_E}{SS_T})(\frac{n-1}{n-p-1})
\]</span></p>
</section>
<section id="exercice-1" class="level3" data-number="0.12">
<h3 data-number="0.12" class="anchored" data-anchor-id="exercice-1"><span class="header-section-number">0.12</span> Exercice 1</h3>
<ol type="1">
<li><p>Estimez le mod√®le de r√©gression lin√©aire simple pour expliquer le prix d‚Äôun repas dans un restaurant italien √† New York par la variable qualit√©.</p></li>
<li><p>Donnez la droite de r√©gression estim√©e.</p></li>
<li><p>Interpr√©tez les estim√©s ponctuels et les intervalles de confiances des param√®tres du mod√®le.</p></li>
<li><p>Une ordonn√©e √† l‚Äôorigine n√©gative fait elle du sens dans ce contexte? Le mod√®le est-il globalement significatif?</p></li>
<li><p>Quelle est la valeur du R¬≤? Interpr√©tez-en la valeur.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R√©gression lin√©aire simple pour pr√©dire le prix en fonction de la qualit√©</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>modele_qualite <span class="ot">&lt;-</span> <span class="fu">lm</span>(Prix <span class="sc">~</span> Qualit√©, <span class="at">data =</span> resto)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le r√©sum√© du mod√®le </span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele_qualite)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Prix ~ Qualit√©, data = resto)

Residuals:
     Min       1Q   Median       3Q      Max 
-21.8860  -3.9470   0.2056   4.2513  26.9919 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -17.8321     5.8631  -3.041  0.00274 ** 
Qualit√©       2.9390     0.2834  10.371  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.261 on 166 degrees of freedom
Multiple R-squared:  0.3932,    Adjusted R-squared:  0.3895 
F-statistic: 107.6 on 1 and 166 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="intervalle-de-confiance-pour-estimer-la-moyenne-conditionnelle-et-intervalle-de-pr√©vision" class="level3" data-number="0.13">
<h3 data-number="0.13" class="anchored" data-anchor-id="intervalle-de-confiance-pour-estimer-la-moyenne-conditionnelle-et-intervalle-de-pr√©vision"><span class="header-section-number">0.13</span> Intervalle de confiance pour estimer la moyenne conditionnelle et intervalle de pr√©vision</h3>
<p>La droite de r√©gression estim√©e peut √™tre utilis√©e pour :</p>
<ol type="1">
<li><p>Estimer la moyenne conditionnelle de Y pour une valeur de x fix√©e.</p></li>
<li><p>Pr√©voir la valeur de Y pour une nouvelle observation de x.</p></li>
</ol>
<ul>
<li><p>Pour le m√™me x fix√©, la valeur <em>≈∑(x)</em> fournit √† la fois une estimation ponctuelle de la moyenne conditionnelle de Y et une pr√©vision ponctuelle de la valeur de Y.</p></li>
<li><p>Cependant, la marge d‚Äôerreur associ√©e √† la pr√©vision sera n√©cessairement plus grande que la marge d‚Äôerreur associ√©e √† l‚Äôestimation de la moyenne.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalle de confiance pour un restaurant d'une qualit√© de 17:</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Cr√©er une nouvelle observation avec qualit√© = 17</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>nouveau_resto <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Qualit√© <span class="ot">=</span> <span class="dv">17</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Pr√©diction du prix avec intervalle de confiance</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>prediction_17 <span class="ot">&lt;-</span> <span class="fu">predict</span>(modele_qualite, <span class="at">newdata =</span> nouveau_resto, <span class="at">interval =</span> <span class="st">"confidence"</span>, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Pr√©diction du prix avec intervalle de pr√©vision</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>prevision_17 <span class="ot">&lt;-</span> <span class="fu">predict</span>(modele_qualite, <span class="at">newdata =</span> nouveau_resto, <span class="at">interval =</span> <span class="st">"prediction"</span>, <span class="at">level =</span> <span class="fl">0.95</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher la pr√©diction</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(prediction_17)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 32.13017 29.83465 34.42569</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher l'intervalle de pr√©vision</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(prevision_17)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 32.13017 17.61227 46.64807</code></pre>
</div>
</div>
<p>Estimation ponctuelle et intervalle de confiance du prix moyen pour un restaurant ayant un score de qualit√© de 17:</p>
<ul>
<li><p>Estim√© du prix moyen= -17.832+2.94*17= 32.13$</p></li>
<li><p>Au niveau de confiance 95%, on estime que <strong>le prix moyen des restaurants ayant un score de qualit√© de 17</strong> est situ√© entre 29.83$ et 34.42</p></li>
<li><p>Au niveau de confiance 95% on estime que <strong>le prix d‚Äôun restaurant ayant un score de qualit√© de 17</strong> est entre 17.61$ et 46.65%.</p></li>
</ul>
</section>
<section id="exercice-2" class="level3" data-number="0.14">
<h3 data-number="0.14" class="anchored" data-anchor-id="exercice-2"><span class="header-section-number">0.14</span> Exercice 2:</h3>
<ol type="1">
<li><p>Ajustez diff√©rents mod√®les de r√©gression lin√©aires simples en fonction des variables explicatives disponibles pour tenter d‚Äôexpliquer le prix du repas dans les restaurants Italiens.</p></li>
<li><p>Pour chacun des mod√®les, pr√©sentez l‚Äô√©quation estim√©e et discutez de la significativit√© des coefficients.</p></li>
<li><p>Pour chacun des mod√®les, interpr√©tez chaque coefficient estim√© dans le contexte du probl√®me.</p></li>
<li><p>Parmi ces mod√®les ajust√©s, lequel vous semble le plus appropri√©?</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R√©gression lin√©aire simple pour pr√©dire le prix en fonction du d√©cor</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>modele_decor <span class="ot">&lt;-</span> <span class="fu">lm</span>(Prix <span class="sc">~</span> D√©cor, <span class="at">data =</span> resto)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le r√©sum√© du mod√®le (coefficients, R¬≤, p-value, etc.)</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele_decor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Prix ~ D√©cor, data = resto)

Residuals:
     Min       1Q   Median       3Q      Max 
-14.9578  -4.4862  -0.4673   4.0422  18.5138 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -1.362      3.292  -0.414     0.68    
D√©cor          2.490      0.184  13.537   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.426 on 166 degrees of freedom
Multiple R-squared:  0.5247,    Adjusted R-squared:  0.5218 
F-statistic: 183.2 on 1 and 166 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cr√©er un scatter plot (nuage de points) pour visualiser la relation entre le d√©cor et le prix</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> resto, <span class="fu">aes</span>(<span class="at">x =</span> D√©cor, <span class="at">y =</span> Prix)) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Points repr√©sent√©s par des cercles vides</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>  <span class="co"># Appliquer un th√®me √©pur√©</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relation entre D√©cor et Prix"</span>, <span class="at">x =</span> <span class="st">"D√©cor"</span>, <span class="at">y =</span> <span class="st">"Prix"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="LIVRABLE_T5_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R√©gression lin√©aire simple pour pr√©dire le prix en fonction du service</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>modele_service <span class="ot">&lt;-</span> <span class="fu">lm</span>(Prix <span class="sc">~</span> Service, <span class="at">data =</span> resto)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le r√©sum√© du mod√®le (coefficients, R¬≤, p-value, etc.)</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele_service)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Prix ~ Service, data = resto)

Residuals:
     Min       1Q   Median       3Q      Max 
-17.6646  -4.7540  -0.2093   4.3368  26.2460 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -11.9778     5.1093  -2.344   0.0202 *  
Service       2.8184     0.2618  10.764   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.153 on 166 degrees of freedom
Multiple R-squared:  0.4111,    Adjusted R-squared:  0.4075 
F-statistic: 115.9 on 1 and 166 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cr√©er un scatter plot  pour visualiser la relation entre le service et le prix</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> resto, <span class="fu">aes</span>(<span class="at">x =</span> Service, <span class="at">y =</span> Prix)) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relation entre Service et Prix"</span>, <span class="at">x =</span> <span class="st">"Service"</span>, <span class="at">y =</span> <span class="st">"Prix"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="LIVRABLE_T5_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R√©gression lin√©aire pour analyser l'effet de l'emplacement sur le prix</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>modele_emplacement <span class="ot">&lt;-</span> <span class="fu">lm</span>(Prix <span class="sc">~</span> Emplacement, <span class="at">data =</span> resto)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le r√©sum√© du mod√®le </span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele_emplacement)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Prix ~ Emplacement, data = resto)

Residuals:
     Min       1Q   Median       3Q      Max 
-25.0189  -7.0189  -0.0189   5.9811  24.5645 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    40.435      1.163  34.770   &lt;2e-16 ***
Emplacement1    3.583      1.464   2.448   0.0154 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 9.157 on 166 degrees of freedom
Multiple R-squared:  0.03483,   Adjusted R-squared:  0.02902 
F-statistic: 5.991 on 1 and 166 DF,  p-value: 0.01542</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualiser la relation entre l'emplacement et le prix avec un boxplot</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> resto, <span class="fu">aes</span>(<span class="at">x =</span> Emplacement, <span class="at">y =</span> Prix)) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span>  </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>  </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution des prix par emplacement"</span>, <span class="at">x =</span> <span class="st">"Emplacement"</span>, <span class="at">y =</span> <span class="st">"Prix"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="LIVRABLE_T5_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exercice-3" class="level3" data-number="0.15">
<h3 data-number="0.15" class="anchored" data-anchor-id="exercice-3"><span class="header-section-number">0.15</span> Exercice 3</h3>
<ol type="1">
<li><p>Estimez le mod√®le de r√©gression lin√©aire multiple pour expliquer le prix d‚Äôun repas dans un restaurant italien √† New York en utilisant toutes les variables disponibles.</p></li>
<li><p>Donnez la droite de r√©gression estim√©e.</p></li>
<li><p>Interpr√©tez les coefficients dans le contexte du probl√®me.</p></li>
<li><p>Le mod√®le est-il globalement significatif?</p></li>
<li><p>Est-ce que toutes les variables contribuent significativement dans ce mod√®le multiple pour expliquer le prix d‚Äôun repas dans un restaurant italien √† New York?</p></li>
<li><p>Quel pourcentage de la variabilit√© des prix d‚Äôun repas dans un restaurant italien √† New York est expliqu√©e par ce mod√®le?</p></li>
</ol>
<p><strong>Le mod√®le complet</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R√©gression lin√©aire multiple pour pr√©dire le prix en fonction de plusieurs variables explicatives</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>modele_complet_resto <span class="ot">&lt;-</span> <span class="fu">lm</span>(Prix <span class="sc">~</span> Qualit√© <span class="sc">+</span> D√©cor <span class="sc">+</span> Service <span class="sc">+</span> Emplacement, <span class="at">data =</span> resto)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le r√©sum√© du mod√®le </span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele_complet_resto)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Prix ~ Qualit√© + D√©cor + Service + Emplacement, 
    data = resto)

Residuals:
     Min       1Q   Median       3Q      Max 
-14.0465  -3.8837   0.0373   3.3942  17.7491 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -24.023800   4.708359  -5.102 9.24e-07 ***
Qualit√©        1.538120   0.368951   4.169 4.96e-05 ***
D√©cor          1.910087   0.217005   8.802 1.87e-15 ***
Service       -0.002727   0.396232  -0.007   0.9945    
Emplacement1   2.068050   0.946739   2.184   0.0304 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.738 on 163 degrees of freedom
Multiple R-squared:  0.6279,    Adjusted R-squared:  0.6187 
F-statistic: 68.76 on 4 and 163 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="r√©gression-avec-variable-service-seulement" class="level3" data-number="0.16">
<h3 data-number="0.16" class="anchored" data-anchor-id="r√©gression-avec-variable-service-seulement"><span class="header-section-number">0.16</span> R√©gression avec variable service seulement</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le r√©sum√© du mod√®le de r√©gression pour la variable Service</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele_service)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Prix ~ Service, data = resto)

Residuals:
     Min       1Q   Median       3Q      Max 
-17.6646  -4.7540  -0.2093   4.3368  26.2460 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -11.9778     5.1093  -2.344   0.0202 *  
Service       2.8184     0.2618  10.764   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.153 on 166 degrees of freedom
Multiple R-squared:  0.4111,    Adjusted R-squared:  0.4075 
F-statistic: 115.9 on 1 and 166 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Il n‚Äôy a pas de lien lin√©aire significatif entre la variable service et le prix quand elle est seul.</p>
</section>
<section id="r√©gression-avec-service-qualit√©-et-d√©cor." class="level3" data-number="0.17">
<h3 data-number="0.17" class="anchored" data-anchor-id="r√©gression-avec-service-qualit√©-et-d√©cor."><span class="header-section-number">0.17</span> R√©gression avec service, qualit√© et d√©cor.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R√©gression lin√©aire multiple pour pr√©dire le prix en fonction du service, de la qualit√© et du d√©cor</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>modele_service_qualite_decor <span class="ot">&lt;-</span> <span class="fu">lm</span>(Prix <span class="sc">~</span> Service <span class="sc">+</span> Qualit√© <span class="sc">+</span> D√©cor, <span class="at">data =</span> resto)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le r√©sum√© du mod√®le </span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele_service_qualite_decor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Prix ~ Service + Qualit√© + D√©cor, data = resto)

Residuals:
     Min       1Q   Median       3Q      Max 
-14.8440  -3.7039  -0.1525   3.6218  19.0576 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -24.6409     4.7536  -5.184 6.33e-07 ***
Service       0.1350     0.3957   0.341    0.733    
Qualit√©       1.5556     0.3731   4.170 4.93e-05 ***
D√©cor         1.8473     0.2176   8.491 1.17e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.803 on 164 degrees of freedom
Multiple R-squared:  0.617, Adjusted R-squared:   0.61 
F-statistic: 88.06 on 3 and 164 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Il y a un lien lin√©aire significatif entre la variable service et le prix, mais cette variable ne contribue plus(p-value=0.733) √† expliquer le prix une fois que l‚Äôon tient compte du d√©cor et de la qualit√©.</p>
<p>La variable Service est tr√®s corr√©l√©e √† la variable qualit√©. (√† suivre‚Ä¶)</p>
</section>
<section id="mod√©lisation-avec-variables-explicatives-cat√©gorielles" class="level3" data-number="0.18">
<h3 data-number="0.18" class="anchored" data-anchor-id="mod√©lisation-avec-variables-explicatives-cat√©gorielles"><span class="header-section-number">0.18</span> Mod√©lisation avec variables explicatives cat√©gorielles</h3>
<p><strong>Rappel:</strong> En r√©gression lin√©aire simple ou multiple, la variable d√©pendante Y doit √™tre <strong>quantitative</strong> mais les pr√©dicteurs (les variables ind√©pendantes X) peuvent √™tre de n‚Äôimporte quel type: quantitatif, nominal, ordinal, binaire.</p>
<ul>
<li><p><strong>Variable binaire</strong><em>:</em> Pour utiliser une variable binaire, il suffit de cr√©er une variable indicatrice qui prend les valeurs 0 et 1 et l‚Äôinclure dans le mod√®le.</p></li>
<li><p><strong>Variable nominale</strong><em>:</em> Pour utiliser une variable nominale ayant k valeurs possibles, il suffit de cr√©er (k ‚Äì 1) variables indicatrices et de les inclure dans le mod√®le.</p></li>
<li><p><strong>Variable ordinale</strong><em>:</em> Selon la situation, une variable ordinale pourra √™tre utilis√©e comme une variable quantitative, en l‚Äôajoutant telle quelle au mod√®le, ou bien comme une variable cat√©gorielle, en la mod√©lisant √† l‚Äôaide de variables indicatrices comme pour une variable nominale. Le choix d√©pendra de la variable elle-m√™me <em>et du nombre de modalit√©s qu‚Äôelle poss√®de</em>.</p></li>
</ul>
</section>
<section id="mise-en-situation-2" class="level3" data-number="0.19">
<h3 data-number="0.19" class="anchored" data-anchor-id="mise-en-situation-2"><span class="header-section-number">0.19</span> Mise en situation 2</h3>
<p>Une importante cha√Æne de magasins compte un tr√®s grand nombre de succursales r√©parties √† travers le Canada et les √âtats-Unis. La direction dispose de certaines donn√©es sur un √©chantillon de 342 succursales.</p>
<p><strong>Variables</strong></p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 4%">
<col style="width: 95%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Nom_Variable</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Profit</td>
<td style="text-align: left;">Profit de l‚Äôann√©e 2016 (en milliers de dollars). Un profit n√©gatif correspond √† une perte.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Budget</td>
<td style="text-align: left;">Budget publicitaire de l‚Äôann√©e 2016 (en milliers de dollars).</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Local</td>
<td style="text-align: left;">√âvaluation globale de la localisation de la succursale (score de 0 √† 100). Calcul√© en fonction de plusieurs crit√®res tels que la taille de la population environnante, le revenu m√©dian, l‚Äôacc√®s par transport en commun et les places de stationnement.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Direction</td>
<td style="text-align: left;">Indice de la qualit√© de la direction de la succursale : 1 = acceptable, 2 = bon, 3 = excellent.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Comp</td>
<td style="text-align: left;">Pr√©sence d‚Äôun comp√©titeur dans un rayon de 5 km : 0 = pas de comp√©titeur, 1 = pr√©sence d‚Äôun comp√©titeur.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Loc_categ</td>
<td style="text-align: left;">Variable indicatrice d√©riv√©e de ‚ÄòLocal‚Äô : 1 si Local &gt;= 50 (bonne localisation), 0 sinon.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># D√©finir le r√©pertoire de travail</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"C:/Users/Fatou/OneDrive - HEC Montr√©al/PROJET SUPERVISE/Data"</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Importer le jeu de donn√©es</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>magasins <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Magasins.csv"</span>,<span class="at">sep=</span><span class="st">";"</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercice-4" class="level3" data-number="0.20">
<h3 data-number="0.20" class="anchored" data-anchor-id="exercice-4"><span class="header-section-number">0.20</span> Exercice 4</h3>
<ol type="1">
<li><p>Donnez le type de chaque variable dans la base de donn√©es.</p></li>
<li><p>Ajustez un mod√®le de r√©gression lin√©aire multiple pour expliquer la variable Profit en utilisant uniquement les variables Budget et Direction (mod√®le 1). Interpr√©tez les coefficients estim√©s obtenus.</p></li>
<li><p>Ajustez un mod√®le de r√©gression lin√©aire multiple pour expliquer la variable Profit incluant toutes les variables dans le mod√®le (mod√®le 2). Interpr√©tez les coefficients estim√©s obtenus.</p></li>
<li><p>Quelle variable explicative semble avoir l‚Äôimpact le plus important sur le Profit dans le mod√®le 2?</p></li>
</ol>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: center;" data-quarto-table-cell-role="th">Variable...Type</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Quantitative</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Qualitative.nominale</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Qualitative.ordinale</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center; font-weight: bold; background-color: lightblue !important;">Profit</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center; font-weight: bold; background-color: lightblue !important;">Budget</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center; font-weight: bold; background-color: lightblue !important;">Local</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center; font-weight: bold; background-color: lightblue !important;">Direction</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center; font-weight: bold; background-color: lightblue !important;">Comp</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">X</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center; font-weight: bold; background-color: lightblue !important;">Loc_categ</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">X</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="d√©marche-et-solution" class="level3" data-number="0.21">
<h3 data-number="0.21" class="anchored" data-anchor-id="d√©marche-et-solution"><span class="header-section-number">0.21</span> D√©marche et solution</h3>
<ul>
<li><p>La variable Direction est ordinale mais ne comporte que trois modalit√©s, on va donc cr√©er deux variables indicatrices pour deux des trois modalit√©s). La cat√©gorie omise sera notre cat√©gorie de r√©f√©rence.</p></li>
<li><p>Les variables Comp et Loc_categ peuvent √™tre introduites telles qu‚Äôelles dans le mod√®le (attention si on d√©cide de choisir la variable locale dans le mod√®le, on n‚Äôutilise plus Loc_categ).</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir les variables cat√©gorielles en facteurs</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>magasins<span class="sc">$</span>Direction <span class="ot">&lt;-</span> <span class="fu">factor</span>(magasins<span class="sc">$</span>Direction)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">#magasins$Comp &lt;- as.factor(magasins$Comp)</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Red√©finir la modalit√© 1 comme modalit√© de r√©f√©rence</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(magasins<span class="sc">$</span>Direction) <span class="ot">&lt;-</span> <span class="fu">contr.treatment</span>(<span class="dv">3</span>, <span class="at">base =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="exercice-4--question-2-mod√®le-1" class="level4" data-number="0.21.1">
<h4 data-number="0.21.1" class="anchored" data-anchor-id="exercice-4--question-2-mod√®le-1"><span class="header-section-number">0.21.1</span> Exercice 4- Question 2: mod√®le 1</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R√©gression lin√©aire multiple pour pr√©dire le profit en fonction du budget et de la direction</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>modele_magasin1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Profit <span class="sc">~</span> Budget <span class="sc">+</span> Direction, <span class="at">data =</span> magasins)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le r√©sum√© du mod√®le </span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele_magasin1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Profit ~ Budget + Direction, data = magasins)

Residuals:
    Min      1Q  Median      3Q     Max 
-226.79  -58.39  -14.58   40.88  323.58 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -17.8348    19.2117  -0.928 0.353898    
Budget        2.0269     0.2544   7.967 2.51e-14 ***
Direction2   28.0467    12.7187   2.205 0.028116 *  
Direction3   49.7672    13.6513   3.646 0.000309 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 90.22 on 338 degrees of freedom
Multiple R-squared:  0.1779,    Adjusted R-squared:  0.1706 
F-statistic: 24.38 on 3 and 338 DF,  p-value: 2.636e-14</code></pre>
</div>
</div>
<p>Le profit moyen estim√© pour un magasin n‚Äôayant aucun budget publicitaire (Budget=0) et une appr√©ciation jug√©e ¬´ acceptable ¬ª du mode de direction (Direction=1; ie, Bon=0 et Excellent=0) est de -17.835 milliers de dollars.</p>
</section>
<section id="exercice-4--question-2-interpr√©tation-des-coefficients" class="level4" data-number="0.21.2">
<h4 data-number="0.21.2" class="anchored" data-anchor-id="exercice-4--question-2-interpr√©tation-des-coefficients"><span class="header-section-number">0.21.2</span> Exercice 4- Question 2: interpr√©tation des coefficients</h4>
<p><em>Budget:</em> Toute chose √©tant √©gale par ailleurs (TCEPA), selon le mod√®le ajust√© le profit moyen augmente en moyenne de 2.027$ pour chaque augmentation d‚Äôun dollar du budget publicitaire.</p>
<p><em>Direction:</em> Introduite par le biais de deux variables indicatrices; Bon et Excellent</p>
<p><em>Excellent:</em> On estime la diff√©rence moyenne de profit entre un magasin ayant un mode de gestion jug√© ¬´&nbsp;Excellent&nbsp;¬ª et un magasin ayant un mode de gestion jug√© ¬´&nbsp;Acceptable&nbsp;¬ª √† 49 767 $ une fois que l‚Äôon contr√¥le pour le niveau du budget publicitaire (TCEPA).</p>
<p><em>Bon</em>: On estime la diff√©rence moyenne de profit entre un magasin ayant un mode de gestion jug√© ¬´&nbsp;Bon&nbsp;¬ª et un magasin ayant un mode de gestion jug√© ¬´&nbsp;Acceptable&nbsp;¬ª √† 28 047 $ une fois que l‚Äôon contr√¥le pour le niveau du budget publicitaire (TCEPA).</p>
<p><span class="math display">\[
\begin{aligned}
\text{Lorsque } \text{Direction} = 1, &amp; \quad \hat{y} = -17.835 + 2.027 \times \text{Budget} \\
\text{Lorsque } \text{Direction} = 2, &amp; \quad \hat{y} = (-17.835 + \mathbf{28.047}) + 2.027 \times \text{Budget} \\
\text{Lorsque } \text{Direction} = 3, &amp; \quad \hat{y} = (-17.835 + \mathbf{49.767}) + 2.027 \times \text{Budget}
\end{aligned}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cr√©er un scatter plot pour visualiser la relation entre Budget et Profit selon la Direction</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(magasins, <span class="fu">aes</span>(<span class="at">x =</span> Budget, <span class="at">y =</span> Profit, <span class="at">color =</span> Direction)) <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span>  </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Budget"</span>, <span class="at">y =</span> <span class="st">"Profit"</span>, <span class="at">title =</span> <span class="st">"Relation entre Budget et Profit selon la Direction"</span>) <span class="sc">+</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
‚Ñπ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="LIVRABLE_T5_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exercice-4--question-3-mod√®le-2" class="level4" data-number="0.21.3">
<h4 data-number="0.21.3" class="anchored" data-anchor-id="exercice-4--question-3-mod√®le-2"><span class="header-section-number">0.21.3</span> Exercice 4- Question 3: Mod√®le 2</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R√©gression lin√©aire multiple pour pr√©dire le profit en fonction du budget, de la direction, </span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># de la localisation et de la pr√©sence d‚Äôun comp√©titeur</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>modele_magasin2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Profit <span class="sc">~</span> Budget <span class="sc">+</span> Direction <span class="sc">+</span> Local <span class="sc">+</span> Comp, <span class="at">data =</span> magasins)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le r√©sum√© du mod√®le </span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele_magasin2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Profit ~ Budget + Direction + Local + Comp, data = magasins)

Residuals:
    Min      1Q  Median      3Q     Max 
-184.36  -56.37  -14.98   48.09  301.28 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -38.0864    23.5819  -1.615   0.1072    
Budget        2.1017     0.2429   8.651  &lt; 2e-16 ***
Direction2   27.1729    12.1980   2.228   0.0266 *  
Direction3   53.3997    13.0313   4.098 5.23e-05 ***
Local         0.4590     0.1932   2.375   0.0181 *  
Comp        -57.4070    10.2958  -5.576 5.07e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 86.02 on 336 degrees of freedom
Multiple R-squared:  0.2572,    Adjusted R-squared:  0.2461 
F-statistic: 23.27 on 5 and 336 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Le profit moyen estim√© pour un magasin, n‚Äôayant aucun budget publicitaire (Budget=0), une localisation m√©diocre (Local=0), une appr√©ciation du mode de direction jug√©e ¬´&nbsp;acceptable&nbsp;¬ª (Bon=0 et Excellent=0) et sans comp√©titeur dans un rayon de 5km, a (-38.086 $).</p>
<p><strong>Mise en garde:</strong> Si une des variables indicatrices s‚Äôav√®re significative et pas les autres, il serait dangereux d‚Äôexclure les variables indicatrices non significatives associ√©e aux modalit√©s de la variable qualitative recod√©e parce que l‚Äôinterpr√©tation des b√™tas en sera alt√©r√©e.</p>
</section>
<section id="exercice-4-question-4-comparaison-des-effets" class="level4" data-number="0.21.4">
<h4 data-number="0.21.4" class="anchored" data-anchor-id="exercice-4-question-4-comparaison-des-effets"><span class="header-section-number">0.21.4</span> Exercice 4-Question 4: Comparaison des effets</h4>
<ul>
<li><p>Comme la taille de chaque param√®tre estim√© b·µ¢ d√©pend de l‚Äôunit√© associ√©e √† la variable X·µ¢, les coefficients estim√©s ne sont donc pas comparables (si les unit√©s de mesures sont diff√©rentes d‚Äôune variable √† une autre).</p></li>
<li><p>La variable budget est exprim√©e en dollars, la localisation est un score allant de 0 √† 100, la variable Comp est une indicatrice sans unit√©‚Ä¶</p></li>
<li><p>On peut √©galement estimer les coefficients standardis√©s Œ≤ dans R √† l‚Äôaide de la fonction <code>lm.beta()</code></p></li>
<li><p>NB: une variable standardis√©e s‚Äôobtient en retranchant de la variable d‚Äôorigine sa moyenne et en la divisant pas son √©cart type.</p></li>
<li><p><strong>Interpr√©tation d‚Äôun coefficient standardis√©</strong>: l‚Äôaugmentation de Y, en moyenne, lorsque la variable explicative augmente de un √©cart type si le tout demeure constant.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Installer et charger le package lm.beta </span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("lm.beta", repos = "https://cloud.r-project.org/")</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lm.beta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: le package 'lm.beta' a √©t√© compil√© avec la version R 4.4.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtenir les coefficients standardis√©s</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>modele_standardise_magasin2 <span class="ot">&lt;-</span> <span class="fu">lm.beta</span>(modele_magasin2)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele_standardise_magasin2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Profit ~ Budget + Direction + Local + Comp, data = magasins)

Residuals:
    Min      1Q  Median      3Q     Max 
-184.36  -56.37  -14.98   48.09  301.28 

Coefficients:
            Estimate Standardized Std. Error t value Pr(&gt;|t|)    
(Intercept) -38.0864           NA    23.5819  -1.615   0.1072    
Budget        2.1017       0.4088     0.2429   8.651  &lt; 2e-16 ***
Direction2   27.1729       0.1371    12.1980   2.228   0.0266 *  
Direction3   53.3997       0.2509    13.0313   4.098 5.23e-05 ***
Local         0.4590       0.1124     0.1932   2.375   0.0181 *  
Comp        -57.4070      -0.2640    10.2958  -5.576 5.07e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 86.02 on 336 degrees of freedom
Multiple R-squared:  0.2572,    Adjusted R-squared:  0.2461 
F-statistic: 23.27 on 5 and 336 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
</section>
<section id="test-de-significativit√©-globale-pour-un-sous-ensemble-de-variable" class="level3" data-number="0.22">
<h3 data-number="0.22" class="anchored" data-anchor-id="test-de-significativit√©-globale-pour-un-sous-ensemble-de-variable"><span class="header-section-number">0.22</span> Test de significativit√© globale pour un sous ensemble de variable</h3>
<ul>
<li><p>Lorsqu‚Äôune variable qualitative comporte plusieurs modalit√©s (k), il est possible de tester son effet global avant de la transformer en <strong>(k-1) variables indicatrices</strong> en utilisant un <strong>mod√®le lin√©aire</strong> dans R avec la fonction <code>lm()</code>.</p>
<p>On applique ensuite un <strong>test ANOVA de type III</strong> sur le mod√®le pour √©valuer la <strong>significativit√© globale</strong> de la variable.</p></li>
<li><p>Exemple si l‚Äôeffet de la variable Direction s‚Äôav√®re significatif au-del√† du Budget, on proc√®de par la suite √† la cr√©ation de variables indicatrices pour les inclure au mod√®le.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Le chargement a n√©cessit√© le package : carData</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">contrasts =</span> <span class="fu">c</span>(<span class="st">"contr.sum"</span>, <span class="st">"contr.poly"</span>))</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Test ANOVA III</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>Anova_magasin2<span class="ot">&lt;-</span><span class="fu">Anova</span>(modele_magasin1,<span class="at">type=</span><span class="st">"III"</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>Anova_magasin2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: Profit
             Sum Sq  Df F value    Pr(&gt;F)    
(Intercept)    7016   1  0.8618  0.353898    
Budget       516731   1 63.4764 2.509e-14 ***
Direction    108403   2  6.6582  0.001458 ** 
Residuals   2751499 338                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="mod√®le-hi√©rarchique-ou-r√©gression-s√©quentielle" class="level3" data-number="0.23">
<h3 data-number="0.23" class="anchored" data-anchor-id="mod√®le-hi√©rarchique-ou-r√©gression-s√©quentielle"><span class="header-section-number">0.23</span> Mod√®le hi√©rarchique ou r√©gression s√©quentielle</h3>
<p>¬´Le terme ¬´ r√©gression hi√©rarchique ¬ª fait r√©f√©rence √† la situation o√π le chercheur d√©cide d‚Äôajuster des mod√®les embo√Æt√©s en entrant tour √† tour <em>des blocs de variables</em> dans le mod√®le et ce, <em>afin de tester des hypoth√®ses de recherche sp√©cifiques</em>. Souvent, les variables formant le premier bloc sont les variables de contr√¥le. Les variables des blocs suivants sont alors souvent les variables d‚Äôint√©r√™t.¬ª Citation tir√©e du recueil Techniques Quantitatives en marketing de Denis Larocque</p>
<p><strong><em>Exemples:</em></strong></p>
<p><strong>1) Tester globalement l‚Äôeffet du mode de gestion (Direction) lorsqu‚Äôon tient compte du Budget publicitaire.</strong></p>
<p>Premier Bloc: variables de contr√¥le: Budget</p>
<p>Deuxi√®me Bloc: variables d‚Äôint√©r√™t: Direction (introduite par l‚Äôentremise de deux variables indicatrices)</p>
<p><strong>2) Est-ce que la variable localisation reste significative une fois que l‚Äôon contr√¥le pour le budget publicitaire, le mode de gestion et la pr√©sence ou non de comp√©titeurs?</strong></p>
<p>Premier Bloc: variables de contr√¥le: Budget, Direction (introduite par l‚Äôentremise de deux variables indicatrices) et Comp</p>
<p>Deuxi√®me Bloc: variables d‚Äôint√©r√™t: Local</p>
<p><strong>Exemples:</strong></p>
<ol type="1">
<li>Tester globalement l‚Äôeffet du mode de gestion (Direction) lorsqu‚Äôon tient compte du Budget publicitaire.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R√©gression lin√©aire simple pour analyser l'effet du budget sur le profit</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>modele_budget <span class="ot">&lt;-</span> <span class="fu">lm</span>(Profit <span class="sc">~</span> Budget, <span class="at">data =</span> magasins)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le r√©sum√© du mod√®le </span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele_budget)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Profit ~ Budget, data = magasins)

Residuals:
    Min      1Q  Median      3Q     Max 
-225.24  -61.93  -15.06   46.22  321.78 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  14.9601    16.3193   0.917     0.36    
Budget        1.9613     0.2578   7.609 2.74e-13 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 91.71 on 340 degrees of freedom
Multiple R-squared:  0.1455,    Adjusted R-squared:  0.143 
F-statistic:  57.9 on 1 and 340 DF,  p-value: 2.741e-13</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R√©gression lin√©aire multiple pour analyser l'effet du budget et de la direction sur le profit</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>modele_budget_direction <span class="ot">&lt;-</span> <span class="fu">lm</span>(Profit <span class="sc">~</span> Budget <span class="sc">+</span> Direction, <span class="at">data =</span> magasins)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le r√©sum√© du mod√®le </span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele_budget_direction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Profit ~ Budget + Direction, data = magasins)

Residuals:
    Min      1Q  Median      3Q     Max 
-226.79  -58.39  -14.58   40.88  323.58 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -17.8348    19.2117  -0.928 0.353898    
Budget        2.0269     0.2544   7.967 2.51e-14 ***
Direction2   28.0467    12.7187   2.205 0.028116 *  
Direction3   49.7672    13.6513   3.646 0.000309 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 90.22 on 338 degrees of freedom
Multiple R-squared:  0.1779,    Adjusted R-squared:  0.1706 
F-statistic: 24.38 on 3 and 338 DF,  p-value: 2.636e-14</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Effectuer un test ANOVA sur le modele budget</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>Anova_budget <span class="ot">&lt;-</span> <span class="fu">anova</span>(modele_budget)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher les r√©sultats de l'ANOVA</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>test_anova_direction<span class="ot">=</span><span class="fu">Anova</span>(modele_budget,modele_budget_direction)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>Anova_budget</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Profit
           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
Budget      1  486992  486992  57.896 2.741e-13 ***
Residuals 340 2859902    8411                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>test_anova_direction</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type II tests)

Response: Profit
           Sum Sq  Df F value    Pr(&gt;F)    
Budget     486992   1  59.823 1.205e-13 ***
Residuals 2751499 338                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>P-value=0.01 permet de r√©pondre au test d‚Äôhypoth√®se relatif √† un sous ensemble de param√®tres dans le mod√®le (√† ne pas confondre avec le test de significativit√© globale de tous les param√®tres du mod√®le):</p>
<p><span class="math display">\[
\begin{aligned}
H_0 &amp;: \beta_{\text{excellent}} = \beta_{\text{bon}} = 0  \quad \text{(aucun changement significatif suite √† l‚Äôajout de la variable Direction : augmentation marginale non significative de } R^2 \text{)} \\
H_1 &amp;: \text{il y a au moins un } \beta \neq 0  \quad \text{(la variable Direction est significative une fois que l‚Äôon tient compte du budget : augmentation marginale significative)}
\end{aligned}
\]</span></p>
<p><em>Est-ce que la variable localisation reste significative une fois que l‚Äôon contr√¥le pour le budget publicitaire, le mode de gestion et la pr√©sence ou non de comp√©titeurs?</em></p>
</section>
<section id="m√©thodes-de-s√©lection-de-mod√®les-stepwise" class="level3" data-number="0.24">
<h3 data-number="0.24" class="anchored" data-anchor-id="m√©thodes-de-s√©lection-de-mod√®les-stepwise"><span class="header-section-number">0.24</span> M√©thodes de S√©lection de mod√®les (Stepwise)</h3>
<p>Plusieurs techniques de s√©lection du meilleur mod√®le sont disponibles dans R.</p>
<p>S√©lection pas √† pas en ajoutant une variable √† la fois, en commen√ßant par la plus significative (stepwise, forward)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mod√®le de r√©gression lin√©aire avec toutes les variables explicatives</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>model_magasin_complet <span class="ot">&lt;-</span> <span class="fu">lm</span>(Profit <span class="sc">~</span> Budget<span class="sc">+</span>Local<span class="sc">+</span>Direction<span class="sc">+</span>Comp, <span class="at">data =</span> magasins)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># R√©gression avec s√©lection de variables stepwise</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>stepwise_model <span class="ot">&lt;-</span> <span class="fu">step</span>(model_magasin_complet, <span class="at">direction =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=3052.86
Profit ~ Budget + Local + Direction + Comp

            Df Sum of Sq     RSS    AIC
&lt;none&gt;                   2486072 3052.9
- Local      1     41747 2527819 3056.6
- Direction  2    126020 2612091 3065.8
- Comp       1    230028 2716100 3081.1
- Budget     1    553761 3039832 3119.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le mod√®le final apr√®s s√©lection des variables</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>stepwise_model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Profit ~ Budget + Local + Direction + Comp, data = magasins)

Coefficients:
(Intercept)       Budget        Local   Direction2   Direction3         Comp  
    -38.086        2.102        0.459       27.173       53.400      -57.407  </code></pre>
</div>
</div>
</section>
<section id="m√©thodes-de-s√©lection-de-mod√®les-backward" class="level3" data-number="0.25">
<h3 data-number="0.25" class="anchored" data-anchor-id="m√©thodes-de-s√©lection-de-mod√®les-backward"><span class="header-section-number">0.25</span> M√©thodes de S√©lection de mod√®les (Backward)</h3>
<p>S√©lection √† partir du mod√®le dans lequel toutes les variables sont incluses et en √©liminant une variable √† la fois en commen√ßant par la moins significative (backward).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mod√®le de r√©gression lin√©aire avec toutes les variables explicatives</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>model_magasin_complet <span class="ot">&lt;-</span> <span class="fu">lm</span>(Profit <span class="sc">~</span> ., <span class="at">data =</span> magasins)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># R√©gression avec s√©lection de variables backward</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>backward_model <span class="ot">&lt;-</span> <span class="fu">step</span>(model_magasin_complet, <span class="at">direction =</span> <span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=3054.76
Profit ~ Budget + Local + Direction + Comp + Loc_categ

            Df Sum of Sq     RSS    AIC
- Loc_categ  1       695 2486072 3052.9
&lt;none&gt;                   2485377 3054.8
- Local      1     22662 2508040 3055.9
- Direction  2    124633 2610010 3067.5
- Comp       1    230629 2716006 3083.1
- Budget     1    553650 3039027 3121.6

Step:  AIC=3052.86
Profit ~ Budget + Local + Direction + Comp

            Df Sum of Sq     RSS    AIC
&lt;none&gt;                   2486072 3052.9
- Local      1     41747 2527819 3056.6
- Direction  2    126020 2612091 3065.8
- Comp       1    230028 2716100 3081.1
- Budget     1    553761 3039832 3119.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le mod√®le final apr√®s s√©lection des variables</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>backward_model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Profit ~ Budget + Local + Direction + Comp, data = magasins)

Coefficients:
(Intercept)       Budget        Local   Direction2   Direction3         Comp  
    -38.086        2.102        0.459       27.173       53.400      -57.407  </code></pre>
</div>
</div>
</section>
<section id="s√©lection-du-meilleur-mod√®le-selon-un-crit√®re" class="level3" data-number="0.26">
<h3 data-number="0.26" class="anchored" data-anchor-id="s√©lection-du-meilleur-mod√®le-selon-un-crit√®re"><span class="header-section-number">0.26</span> S√©lection du meilleur mod√®le selon un crit√®re</h3>
<ul>
<li><p>Construire tous les mod√®les possibles et choisir le meilleur sous-ensemble de variables selon un certain crit√®re sp√©cifique (ex: R¬≤ ajust√©).</p></li>
<li><p>Si on a K pr√©dicteurs, on peut construire (2·µè‚àí1 ) mod√®les √† comparer.</p></li>
<li><p>Plus k est grand, plus il devient difficile de proc√©der ainsi.</p></li>
</ul>
<p><strong>Exemple</strong></p>
<p>On dispose de 3 variables explicatives pour ajuster un mod√®le de r√©gression lin√©aire. On peut ajuster donc 7 mod√®les diff√©rents et les comparer entre eux selon le R¬≤ ajust√©.</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Comparaison des mod√®les</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Mod√®les</th>
<th style="text-align: left;">R..ajust√©</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Avec X1</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Avec X2</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Avec X3</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Avec X1 et X2</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Avec X1 et X3</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Avec X2 et X3</td>
<td style="text-align: left;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Avec X1, X2 et X3</td>
<td style="text-align: left;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="interaction" class="level3" data-number="0.27">
<h3 data-number="0.27" class="anchored" data-anchor-id="interaction"><span class="header-section-number">0.27</span> Interaction</h3>
<ul>
<li><p>Il y a interaction entre deux variables explicatives X·µ¢ et X‚±º si l‚Äôeffet d‚Äôune de ces variables sur les variations de Y n‚Äôest pas le m√™me selon la valeur de l‚Äôautre variable et vice versa.</p></li>
<li><p>Il y a une interaction entre deux variables lorsque l‚Äôeffet entre les deux variables est multiplicatif et pas uniquement additif.</p></li>
<li><p>l‚Äôinteraction entre les deux variables X·µ¢ et X‚±º se fait via la cr√©ation d‚Äôune nouvelle variable √©gale au produit des deux.</p></li>
<li><p>On ajoute ensuite au mod√®le le produit (X·µ¢ * X‚±º ) en plus des variables explicatives X·µ¢ et X‚±º.</p></li>
<li><p>On teste le param√®tre associ√© √† l‚Äôinteraction pour √©valuer sa significativit√©.</p></li>
</ul>
<p><strong>Remarque:</strong> Le choix des termes d‚Äôinteraction √† inclure dans le mod√®le se fait si on soup√ßonne un effet multiplicatif entre les variables.</p>
</section>
<section id="exemple-pour-illustrer-linteraction" class="level3" data-number="0.28">
<h3 data-number="0.28" class="anchored" data-anchor-id="exemple-pour-illustrer-linteraction"><span class="header-section-number">0.28</span> Exemple pour illustrer l‚Äôinteraction</h3>
<ul>
<li><p>On soup√ßonne que l‚Äôeffet du budget sur le profit n‚Äôest pas le m√™me selon que l‚Äôon soit dans une zone o√π les comp√©titeurs y sont ou pas.</p></li>
<li><p>Pour r√©pondre √† cette hypoth√®se, on va ajuster un mod√®le de r√©gression lin√©aire multiple pour expliquer le profit en fonction du budget publicitaire, de comp et d‚Äôune variable d‚Äôint√©raction <strong>budget_comp= Budget*comp</strong>.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mod√®le de r√©gression lin√©aire avec interaction entre Budget et Comp√©titeur</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>modele_magasin3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Profit <span class="sc">~</span> Budget <span class="sc">+</span> Comp <span class="sc">+</span> Budget <span class="sc">*</span> Comp, <span class="at">data =</span> magasins)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le r√©sum√© du mod√®le </span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele_magasin3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Profit ~ Budget + Comp + Budget * Comp, data = magasins)

Residuals:
    Min      1Q  Median      3Q     Max 
-180.57  -58.37  -11.26   48.66  307.96 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  22.5274    18.4977   1.218    0.224    
Budget        2.1003     0.2941   7.142 5.68e-12 ***
Comp        -34.9596    35.3004  -0.990    0.323    
Budget:Comp  -0.3190     0.5524  -0.577    0.564    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 88.51 on 338 degrees of freedom
Multiple R-squared:  0.2088,    Adjusted R-squared:  0.2018 
F-statistic: 29.73 on 3 and 338 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>ùëôùëí ùëöùëúùëë√®ùëôùëí ùëéùëóùë¢ùë†ùë°√© ùëíùë†ùë° : ùë¶=22.527+2.1 ‚àó ùêµùë¢ùëëùëîùëíùë°‚àí34.96 ‚àó ùê∂ùëúùëöùëù‚àíùüé.ùüëùüèùüó ‚àó (ùëèùë¢ùëëùëîùëíùë°‚àóùê∂ùëúùëöùëù)</p>
<p>Il est plus facile d‚Äôinterpr√©ter ce mod√®le selon la variable Comp:</p>
<p>ùëÉùëüùëúùëìùëñùë° (ùëêùëúùëöùëù=0)=22.527+2.1‚àóùëèùë¢ùëëùëîùëíùë°</p>
<p>ùëÉùëüùëúùëìùëñùë° (ùëêùëúùëöùëù=1)=(22.527‚àí34.960)+(2.1‚àí0.319) ‚àó ùëèùë¢ùëëùëîùëíùë°</p>
<p>Dans cet exemple:</p>
<ol type="1">
<li><p>l‚Äôordonn√©e √† l‚Äôorigine (comp=1) n‚Äôest pas significativement diff√©rente de celle de (comp=0) (p-value=0.323).</p></li>
<li><p>l‚Äôeffet du budget est le m√™me peut importe se situe le magasin (p-value=0.564).</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cr√©er un scatter plot (nuage de points) pour visualiser la relation entre Budget et Profit selon la pr√©sence d'un comp√©titeur</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(magasins, <span class="fu">aes</span>(<span class="at">x =</span> Budget, <span class="at">y =</span> Profit, <span class="at">color =</span> Comp)) <span class="sc">+</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span>  </span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Budget"</span>, <span class="at">y =</span> <span class="st">"Profit"</span>, <span class="at">title =</span> <span class="st">"Relation entre Budget et Profit selon la Pr√©sence d'un Comp√©titeur"</span>) <span class="sc">+</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The following aesthetics were dropped during statistical transformation:
colour.
‚Ñπ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
‚Ñπ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="LIVRABLE_T5_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="multicolin√©arit√©" class="level3" data-number="0.29">
<h3 data-number="0.29" class="anchored" data-anchor-id="multicolin√©arit√©"><span class="header-section-number">0.29</span> Multicolin√©arit√©</h3>
<ul>
<li><p>Si le seul but de la r√©gression est de d√©terminer un mod√®le pour faire de la pr√©vision, la multicolin√©arit√© n‚Äôest pas si grave, mais si l‚Äôobjectif est de construire un mod√®le explicatif (parcimonieux) pour analyser le comportement de Y en fonction des variables explicatives pertinentes, alors le probl√®me est plus grave car les estimations des param√®tres est <strong>moins pr√©cise</strong> (√©cart type √©lev√©).</p></li>
<li><p>Si deux variables explicatives sont <strong>fortement corr√©l√©es</strong> (|ùíì|&gt;ùüé.ùüñ), <strong>alors on peut se d√©barrasser de l‚Äôune de ces deux variables</strong>.</p></li>
<li><p>Le diagnostic de la multicolin√©arit√© par le biais du coefficient de corr√©lation bivari√© (deux par deux) n‚Äôest pas suffisant car plusieurs variables explicatives peuvent √™tre tr√®s corr√©l√©es √† une <em>combinaison lin√©aire</em> des autres variables explicatives.</p></li>
</ul>
<p>Les autres variables explicatives, comme Qualit√© et D√©cor, sont respectivement fortement (|r| = 0.795) et mod√©r√©ment (|r| = 0.645) corr√©l√©es avec la variable Service. (Voir le tableau de corr√©lation plus haut.)</p>
</section>
<section id="diagnostic-de-la-multicolin√©arit√©" class="level3" data-number="0.30">
<h3 data-number="0.30" class="anchored" data-anchor-id="diagnostic-de-la-multicolin√©arit√©"><span class="header-section-number">0.30</span> Diagnostic de la multicolin√©arit√©</h3>
<p><strong>Le ¬´&nbsp;Variance inflation factor&nbsp;¬ª not√© VIF</strong></p>
<p>Pour une variable explicative donn√©e X·µ¢, <span class="math display">\[ VIF(i) = \frac{1}{1 - R^2(i)} \]</span><br>
ùëú√π R¬≤(ùëñ) est le coeff de determination du mod√®le ajust√© en regressant X·µ¢ en fonction de toutes les autres variables explicatives.</p>
<p>R√®gle g√©n√©rale un VIF &gt; 10 signale un probl√®me de multicolin√©arit√©.</p>
<p>Exemple: Un VIF=5 implique un R¬≤ (ùëñ)= 0.8. 80% de la variabilit√© observ√©e dans X·µ¢ est expliqu√©e par les autres variables explicatives.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Charger la biblioth√®que </span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer le VIF des variables explicatives du mod√®le pour d√©tecter la colin√©arit√©</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(modele_complet_resto)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Qualit√©       D√©cor     Service Emplacement 
   2.714261    1.744851    3.558735    1.064985 </code></pre>
</div>
</div>
<p>On ne d√©tecte pas de probl√®me de multicolin√©arit√© dans notre exemple car les VIF&lt;10.</p>
</section>
<section id="validit√©-du-mod√®le-de-r√©gression-lin√©aire" class="level3" data-number="0.31">
<h3 data-number="0.31" class="anchored" data-anchor-id="validit√©-du-mod√®le-de-r√©gression-lin√©aire"><span class="header-section-number">0.31</span> Validit√© du mod√®le de r√©gression lin√©aire</h3>
<p>La validit√© du mod√®le de r√©gression lin√©aire repose sur 4 hypoth√®ses:</p>
<p><em>Hypoth√®se 1 :</em> Les erreurs …õ·µ¢ sont de moyenne nulle (condition de lin√©arit√© du mod√®le);</p>
<p><em>Hypoth√®se 2 :</em> La variance des erreurs reste constante;</p>
<p><em>Hypoth√®se 3 :</em> Les erreurs …õ·µ¢ sont ind√©pendantes (m√©thodes d‚Äô√©chantillonnage);</p>
<p><em>Hypoth√®se 4 :</em> Les erreurs …õ·µ¢ sont distribu√©es selon une loi Normale (plus l‚Äô√©chantillon est ¬´ grand ¬ª, moins cette condition est importante);</p>
<p>On limitera notre analyse des r√©sidus (hypoth√®ses 1,2 et 4), dans le cadre de ce cours, √† un examen graphique de la distribution des erreurs standardis√©es en fonction des variables explicatives.</p>
</section>
<section id="√©tapes-pour-valider-le-mod√®le" class="level3" data-number="0.32">
<h3 data-number="0.32" class="anchored" data-anchor-id="√©tapes-pour-valider-le-mod√®le"><span class="header-section-number">0.32</span> √âtapes pour valider le mod√®le</h3>
<p>Mod√®le Profit=‚àíùüëùüñ.ùüéùüñùüî+ùüê.ùüèùüéùüê ‚àó ùêµùë¢ùëëùëîùëíùë°‚àíùüìùüï.ùüíùüéùüï ‚àó ùê∂ùëúùëöùëù+ùüé.ùüíùüìùüó ‚àó ùêøùëúùëêùëéùëô+ùüêùüï.ùüèùüïùüë ‚àóùêµùëúùëõ+ùüìùüë.ùüí ‚àó ùê∏ùë•ùëêùëíùëôùëôùëíùëõùë°</p>
<p><em>Premi√®re √©tape:</em> calculer les erreurs standardis√©es.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer les valeurs pr√©dictives standardis√©es du mod√®le</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>magasins<span class="sc">$</span>valeurs_predites_std <span class="ot">&lt;-</span> <span class="fu">scale</span>(<span class="fu">predict</span>(modele_magasin2))</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer les r√©sidus standardis√©s du mod√®le</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>magasins<span class="sc">$</span>residus_std <span class="ot">&lt;-</span> <span class="fu">rstandard</span>(modele_magasin2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Deuxi√®me √©tape:</em> Construire les graphiques des r√©sidus en fonction des variables explicatives.</p>
<ul>
<li><p>Si X est continue ‚Äî‚Äî Scatterplot (nuage de points)</p></li>
<li><p>Si X est cat√©g√©rielle ‚Äî‚Äî Boxplot par modalit√©(groupe)</p></li>
</ul>
<p>Les points doivent √™tre dispos√©s al√©atoirement dans le graphique (aucun pattern anormal).</p>
<p><em>Troisi√®me √©tape</em>: construire l‚Äôhistogramme des r√©sidus standardis√©s:</p>
<ul>
<li><p>la forme de l‚Äôhistogramme doit se rapprocher d‚Äôune distribution normale autour d‚Äôune moyenne de 0 et d‚Äô√©cart type d‚Äôenviron 1.</p></li>
<li><p>95% des r√©sidus standardis√©s doivent √™tre situ√©s √† [-2; 2] (r√®gle empirique d‚Äôune distribution normale)</p></li>
</ul>
<p>Exemple: Validation avec <em>variable Budget</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cr√©er un scatter plot pour analyser la distribution des r√©sidus standardis√©s en fonction du budget</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(magasins, <span class="fu">aes</span>(<span class="at">x =</span> Budget, <span class="at">y =</span> residus_std)) <span class="sc">+</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  </span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span> </span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Budget"</span>, <span class="at">y =</span> <span class="st">"R√©sidus standardis√©s"</span>, <span class="at">title =</span> <span class="st">"Graphique des r√©sidus standardis√©s"</span>) <span class="sc">+</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="LIVRABLE_T5_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Exemple: Validation avec <em>variable Direction</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cr√©er un boxplot pour analyser la distribution des r√©sidus standardis√©s selon la Direction</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(magasins, <span class="fu">aes</span>(<span class="at">x =</span> Direction, <span class="at">y =</span> residus_std)) <span class="sc">+</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span>  </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">median</span>(magasins<span class="sc">$</span>residus_std), <span class="at">linetype =</span> <span class="st">"solid"</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span>   </span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Direction"</span>, <span class="at">y =</span> <span class="st">"R√©sidus standardis√©s"</span>, <span class="at">title =</span> <span class="st">"Distribution des r√©sidus standardis√©s par Direction"</span>) <span class="sc">+</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="LIVRABLE_T5_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Exemple: Validation avec l<em>‚Äôhistogramme des erreurs</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tracer l'histogramme des r√©sidus standardis√©s avec une courbe de densit√©</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(magasins, <span class="fu">aes</span>(<span class="at">x =</span> residus_std)) <span class="sc">+</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..),  </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bins =</span> <span class="dv">30</span>, </span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">"khaki"</span>, </span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>  </span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution des r√©sidus standardis√©s"</span>,</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"R√©sidus standardis√©s"</span>,</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Densit√©"</span>) <span class="sc">+</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.
‚Ñπ Please use `after_stat(density)` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="LIVRABLE_T5_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Conclusion</strong></p>
<p>Rien ne semble indiquer une violation aux hypoth√®ses sur lesquelles repose le mod√®le de r√©gression lin√©aire.</p>
<p>Si les hypoth√®ses ne sont pas v√©rifier, pensez √† transformer soit la variables d√©pendantes et/ou les variables ind√©pendantes pour s‚Äôapprocher de l‚Äôhypoth√®se de lin√©arit√©.</p>
</section>
<section id="transformation" class="level3" data-number="0.33">
<h3 data-number="0.33" class="anchored" data-anchor-id="transformation"><span class="header-section-number">0.33</span> Transformation</h3>
<p>Exemple:</p>
<p>Le fichier (fictif) epicerie.csv contient les informations suivantes sur 100 000 adultes vivant seuls et d√©tenant une carte fid√©lit√© du supermarch√©&nbsp;:</p>
<p><strong>Variables</strong></p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Nom_Variable</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">D√©pense</td>
<td style="text-align: left;">Le montant d√©pens√© annuellement dans ce supermarch√©.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Revenu</td>
<td style="text-align: left;">Le revenu annuel net avant imp√¥t de ce client.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># D√©finir le r√©pertoire de travail</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"C:/Users/Fatou/OneDrive - HEC Montr√©al/PROJET SUPERVISE/Data"</span>)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Importer le jeu de donn√©es</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>epicerie <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"epicerie.csv"</span>, <span class="at">sep=</span><span class="st">";"</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir log_revenu en num√©rique </span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>epicerie<span class="sc">$</span>log_revenu <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">"."</span>, epicerie<span class="sc">$</span>log_revenu))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>En utilisant R, trouvez un bon mod√®le permettant de pr√©voir les d√©penses √† partir du revenu.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cr√©er un scatter plot  pour visualiser la relation entre Revenu et D√©penses</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(epicerie, <span class="fu">aes</span>(<span class="at">x =</span> Revenu, <span class="at">y =</span> D√©penses)) <span class="sc">+</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  </span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Revenu"</span>, <span class="at">y =</span> <span class="st">"D√©penses"</span>, <span class="at">title =</span> <span class="st">"Relation entre Revenu et D√©penses"</span>) <span class="sc">+</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="LIVRABLE_T5_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R√©gression lin√©aire simple pour analyser l'effet du revenu sur les d√©penses</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>modele_epicerie_revenu <span class="ot">&lt;-</span> <span class="fu">lm</span>(D√©penses <span class="sc">~</span> Revenu, <span class="at">data =</span> epicerie)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le r√©sum√© du mod√®le </span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele_epicerie_revenu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = D√©penses ~ Revenu, data = epicerie)

Residuals:
    Min      1Q  Median      3Q     Max 
-3803.6  -361.4    46.1   422.0  2243.5 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 4.914e+03  5.426e+00   905.6   &lt;2e-16 ***
Revenu      4.420e-02  7.641e-05   578.5   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 636.4 on 99998 degrees of freedom
Multiple R-squared:  0.7699,    Adjusted R-squared:  0.7699 
F-statistic: 3.346e+05 on 1 and 99998 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cr√©er un scatter plot  pour visualiser la relation entre le log du revenu et les d√©penses</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(epicerie, <span class="fu">aes</span>(<span class="at">x =</span> log_revenu, <span class="at">y =</span> D√©penses)) <span class="sc">+</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span>  </span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Log(Revenu)"</span>, <span class="at">y =</span> <span class="st">"D√©penses"</span>, <span class="at">title =</span> <span class="st">"Relation entre le Log du Revenu et les D√©penses"</span>) <span class="sc">+</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="LIVRABLE_T5_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R√©gression lin√©aire simple pour analyser l'effet du log du revenu sur les d√©penses</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>modele_epicerie_log_revenu <span class="ot">&lt;-</span> <span class="fu">lm</span>(D√©penses <span class="sc">~</span> log_revenu, <span class="at">data =</span> epicerie)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le r√©sum√© du mod√®le </span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele_epicerie_log_revenu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = D√©penses ~ log_revenu, data = epicerie)

Residuals:
    Min      1Q  Median      3Q     Max 
-2256.5  -337.2     1.1   337.8  2107.8 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -22983.496     39.726  -578.6   &lt;2e-16 ***
log_revenu    2798.607      3.605   776.2   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 500.5 on 99998 degrees of freedom
Multiple R-squared:  0.8577,    Adjusted R-squared:  0.8577 
F-statistic: 6.025e+05 on 1 and 99998 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="ajout-de-termes-polynomiaux" class="level3" data-number="0.34">
<h3 data-number="0.34" class="anchored" data-anchor-id="ajout-de-termes-polynomiaux"><span class="header-section-number">0.34</span> Ajout de termes polynomiaux</h3>
<ul>
<li><p>Une droite peut ne pas √™tre ad√©quate pour mod√©liser la relation entre X et Y. L‚Äôutilisation de termes polynomiaux d‚Äôordre 2 ou 3 peut am√©liorer la performance d‚Äôun mod√®le.</p></li>
<li><p>L‚Äôinterpr√©tation de ces termes demeure un d√©fi. C‚Äôest la raison pour laquelle ce genre de manipulation est plus utilis√© pour la construction de mod√®le pr√©dictif.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cr√©er un scatter plot et ajuster une r√©gression lin√©aire</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span>  </span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span> </span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"R√©gression Lin√©aire (Mauvais Ajustement ?)"</span>, <span class="at">x =</span> <span class="st">"x"</span>, <span class="at">y =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="LIVRABLE_T5_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cr√©er un scatter plot et ajuster une r√©gression quadratique</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span>  </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">2</span>), <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"R√©gression Quadratique (Bon Ajustement ?)"</span>, <span class="at">x =</span> <span class="st">"x"</span>, <span class="at">y =</span> <span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="LIVRABLE_T5_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>